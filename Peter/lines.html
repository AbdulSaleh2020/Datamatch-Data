<!DOCTYPE html>

<head>
	<meta charset="utf-8">
	<link href="https://fonts.googleapis.com/css?family=Sintony:700" rel="stylesheet">
</head>

<style type="text/css">

	.button {
            display: inline-block;
            padding: .8em;
            background-color: #B7B7B7;
            text-decoration: none;
            color: white;
       		margin-left: 1%;
            margin-right: 1%;
        }
        
        .hvr-fade {
            display: inline-block;
            vertical-align: middle;
            -webkit-transform: perspective(1px) translateZ(0);
            transform: perspective(1px) translateZ(0);
            box-shadow: 0 0 1px transparent;
            overflow: hidden;
            -webkit-transition-duration: 0.3s;
            transition-duration: 0.3s;
            -webkit-transition-property: color, background-color;
            transition-property: color, background-color;
        }

        .hvr-fade:hover, .hvr-fade:focus, .hvr-fade:active {
            background-color: #9B1B00;
            color: white;
        }

	#my-wrapper {
         position:relative; 
         padding-top: 15px;
    }

    #title {
         font-family: 'Sintony', sans-serif;
         font-size: 36px;
         text-align: center;
         margin-top: 0px;
         
    }

    svg {
    	font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }

    #subtitle{
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            font-size: 14px;
            vertical-align: center;
            text-align: center;
            margin: auto;
            padding-top: .6%;
            max-width: 490px;
            font-weight: medium;
            padding-bottom: 1%;
        }

     .selected {
            background-color: #9B1B00;
        }

</style>

<body style="background-color: #E7E7E7;">
	<div id="my-wrapper">
		<div id="title">
			Live Sign-Ups
		</div>
		<div id="subtitle">
			Check out how many people are signing in to Datamatch live in the graph below. Filter by gender, house, or year.
		</div>
		<center>
			
			<div id="button-container">
				<center> 
						<input style="float: bottom; z-index: 1;" class="filter-button button hvr-fade" type="button" name="dataset" value="Gender" onClick="clicked(1)">
        				<input style="float: bottom; z-index: 1;" class="filter-button button hvr-fade" type="button" name="dataset" value="House" onClick="clicked(2)">
        				<input style="float: bottom; z-index: 1;" class="filter-button button hvr-fade" type="button" name="dataset" value="Year" onClick="clicked(3)">
        			</center>
				<svg width="960" height="500" style="z-index: 0;"></svg>
    		</div>
			
		</center>
	</div>
</body>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script>
var clickedvar = 0;

function clicked(n){

	if (n==1) {
		clickedvar = 1;
	}
	else if (n==2) {
		clickedvar = 2;
	}
	else if (n==3) {
		clickedvar = 3;
	}
}




var svg = d3.select("svg"),
    margin = {top: 70, right: 80, bottom: 90, left: 100},
    width = +svg.attr("width") - margin.left - margin.right,
    height = +svg.attr("height") - margin.top - margin.bottom,
    g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");


var total_people = 1;
var times_array;
var boys_array;
var girls_array;

var parseTime = d3.timeParse("%d-%b-%y");

var x = d3.scaleTime()
    .rangeRound([0, width]);

var y = d3.scaleLinear()
    .rangeRound([height, 0]);

var line = d3.line()
    .x(function(d) { return x(d.date); })
    .y(function(d) { return y(d.response); });

function randomDate(start, end) {
    return new Date(start.getTime() + Math.random()*(end.getTime() - start.getTime()));
}

d3.json("times.json", function(d) {
  console.log(d.times);
  times_array = d.times
  times_array = times_array;
  times_array
  .forEach(function(d) {
      if (d.signup_time == null) {
        // thing = new Date(Date.parse("2016-02-09T07:31:30.000Z"));
        d.date = randomDate(new Date(Date.parse("2016-02-07T07:31:30.000Z")), new Date(Date.parse("2017-01-30T05:30:49.000Z")))
      } 
      else {
        d.date = new Date(Date.parse(d.signup_time));
      }
  })
  times_array.sort(function (a,b) {return (new Date(a.date) - new Date(b.date))})
  times_array.forEach(function(d){
      d.response = total_people
      total_people +=1

  })
     

d3.selectAll("input.filter-button").on('click', function(){
		d3.selectAll("input.filter-button").classed("selected", false)
        d3.select(this).classed("selected", true);
        if (clickedvar == 0){
  x.domain(d3.extent(times_array, function(d) { return d.date; }));
  y.domain(d3.extent(times_array, function(d) { return d.response; }));

  g.append("path")
    .datum(times_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "steelblue")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                        
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {   
      d3.select(this)
      .style("stroke-width",'2.5px')});
}

//GENDER
else if (clickedvar == 1){

  girls_array = times_array
  girls_array = girls_array.filter(function(n){return (n.gender=="Female");})
  var total_girls = 1;
  girls_array.forEach(function(d){
    d.response = total_girls
    total_girls += 1;
    })

  //Boys Array Stuff
  boys_array = times_array
  boys_array = boys_array.filter(function(n){return (n.gender=="Male");})
  var total_boys = 1;
  boys_array.forEach(function(d){
    d.response = total_boys
    total_boys += 1;
    })

  //They all have same date extent
  x.domain(d3.extent(times_array, function(d) { return d.date; }));
  //Must find max extent of response axis
  var extent = [0,0];
  var girl_extent = d3.extent(girls_array, function(d) { return d.response; });
  var boy_extent = d3.extent(boys_array, function(d) { return d.response; });
  extent[0] = Math.min(girl_extent[0], boy_extent[0])
  extent[1] = Math.max(girl_extent[1], boy_extent[1])
  y.domain(extent);

  g.append("path")
    .datum(girls_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#FF3368")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                         
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(boys_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#0021B1")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                 
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        
      d3.select(this)
      .style("stroke-width",'2.5px')});
} //End if statement
//END OF GENDER
//YEAR

//Freshman Stuff

else if(clickedvar == 3){
  freshman_array = times_array
  freshman_array = freshman_array.filter(function(n){return (n.class_year=="Freshman");})
  var total_freshman = 1;
  freshman_array.forEach(function(d){
    d.response = total_freshman
    total_freshman += 1;
    })

//Sophomore Stuff
  sophomore_array = times_array
  sophomore_array = sophomore_array.filter(function(n){return (n.class_year=="Sophomore");})
  var total_sophomores = 1;
  sophomore_array.forEach(function(d){
    d.response = total_sophomores
    total_sophomores += 1;
    })

//Junior Stuff
  junior_array = times_array
  junior_array = junior_array.filter(function(n){return (n.class_year=="Junior");})
  var total_juniors = 1;
  junior_array.forEach(function(d){
    d.response = total_juniors
    total_juniors += 1;
    })

//Senior Stuff
  senior_array = times_array
  senior_array = senior_array.filter(function(n){return (n.class_year=="Senior");})
  var total_seniors = 1;
  senior_array.forEach(function(d){
    d.response = total_seniors
    total_seniors += 1;
    })

  //They all have same date extent
  x.domain(d3.extent(times_array, function(d) { return d.date; }));
  //Must find max extent of response axis
  var extent = [0,0];
  var freshman_extent = d3.extent(freshman_array, function(d) { return d.response; });
  var sophomore_extent = d3.extent(sophomore_array, function(d) { return d.response; });
  var junior_extent = d3.extent(junior_array, function(d) { return d.response; });
  var senior_extent = d3.extent(senior_array, function(d) { return d.response; });
  extent[0] = Math.min(freshman_extent[0], sophomore_extent[0], junior_extent[0], senior_extent[0])
  extent[1] = Math.max(freshman_extent[1], sophomore_extent[1], junior_extent[1], senior_extent[1])
  y.domain(extent);

  g.append("path")
    .datum(freshman_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#edff54")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(sophomore_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#6be5e5")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(junior_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#ff884c")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(senior_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#e0332a")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

}
//END OF YEAR

else if(clickedvar == 2){

  mather_array = times_array
  mather_array = mather_array.filter(function(n){return (n.dorm=="Mather");})
  var total_mather = 1;
  mather_array.forEach(function(d){
    d.response = total_mather
    total_mather += 1;
    })

//Dunster Stuff
  dunster_array = times_array
  dunster_array = dunster_array.filter(function(n){return (n.dorm=="Dunster");})
  var total_dunster = 1;
  dunster_array.forEach(function(d){
    d.response = total_dunster
    total_dunster += 1;
    })

//Leverett Stuff
  leverett_array = times_array
  leverett_array = leverett_array.filter(function(n){return (n.dorm=="Leverett");})
  var total_leverett = 1;
  leverett_array.forEach(function(d){
    d.response = total_leverett
    total_leverett += 1;
    })

//Kirkland Stuff
  kirkland_array = times_array
  kirkland_array = kirkland_array.filter(function(n){return (n.dorm=="Kirkland");})
  var total_kirkland = 1;
  kirkland_array.forEach(function(d){
    d.response = total_kirkland
    total_kirkland += 1;
    })
    
  eliot_array = times_array
  eliot_array = eliot_array.filter(function(n){return (n.dorm=="Eliot");})
  var total_eliot = 1;
  eliot_array.forEach(function(d){
    d.response = total_eliot
    total_eliot += 1;
    })

//Dunster Stuff
  winthrop_array = times_array
  winthrop_array = winthrop_array.filter(function(n){return (n.dorm=="Winthrop");})
  var total_winthrop = 1;
  winthrop_array.forEach(function(d){
    d.response = total_winthrop
    total_winthrop += 1;
    })

//Leverett Stuff
  lowell_array = times_array
  lowell_array = lowell_array.filter(function(n){return (n.dorm=="Lowell");})
  var total_lowell = 1;
  lowell_array.forEach(function(d){
    d.response = total_lowell
    total_lowell += 1;
    })

//Kirkland Stuff
  quincy_array = times_array
  quincy_array = quincy_array.filter(function(n){return (n.dorm=="Quincy");})
  var total_quincy = 1;
  quincy_array.forEach(function(d){
    d.response = total_quincy
    total_quincy += 1;
    })

  adams_array = times_array
  adams_array = adams_array.filter(function(n){return (n.dorm=="Adams");})
  var total_adams = 1;
  adams_array.forEach(function(d){
    d.response = total_adams
    total_adams += 1;
    })

//Dunster Stuff
  cabot_array = times_array
  cabot_array = cabot_array.filter(function(n){return (n.dorm=="Cabot");})
  var total_cabot = 1;
  cabot_array.forEach(function(d){
    d.response = total_cabot
    total_cabot += 1;
    })

//Leverett Stuff
  currier_array = times_array
  currier_array = currier_array.filter(function(n){return (n.dorm=="Currier");})
  var total_currier = 1;
  currier_array.forEach(function(d){
    d.response = total_currier
    total_currier += 1;
    })

//Kirkland Stuff
  pforzheimer_array = times_array
  pforzheimer_array = pforzheimer_array.filter(function(n){return (n.dorm=="Pforzheimer");})
  var total_pforzheimer = 1;
  pforzheimer_array.forEach(function(d){
    d.response = total_pforzheimer
    total_pforzheimer += 1;
    })

  //They all have same date extent
  x.domain(d3.extent(times_array, function(d) { return d.date; }));
  //Must find max extent of response axis
  var extent = [0,0];
  var mather_extent = d3.extent(mather_array, function(d) { return d.response; });
  var dunster_extent = d3.extent(dunster_array, function(d) { return d.response; });
  var leverett_extent = d3.extent(leverett_array, function(d) { return d.response; });
  var kirkland_extent = d3.extent(kirkland_array, function(d) { return d.response; });
  var eliot_extent = d3.extent(eliot_array, function(d) { return d.response; });
  var winthrop_extent = d3.extent(winthrop_array, function(d) { return d.response; });
  var quincy_extent = d3.extent(quincy_array, function(d) { return d.response; });
  var lowell_extent = d3.extent(lowell_array, function(d) { return d.response; });
  var adams_extent = d3.extent(adams_array, function(d) { return d.response; });
  var cabot_extent = d3.extent(cabot_array, function(d) { return d.response; });
  var currier_extent = d3.extent(currier_array, function(d) { return d.response; });
  var pforzheimer_extent = d3.extent(pforzheimer_array, function(d) { return d.response; });
  
  extent[0] = Math.min(mather_extent[0], dunster_extent[0], leverett_extent[0], kirkland_extent[0], eliot_extent[0], winthrop_extent[0], quincy_extent[0], lowell_extent[0], adams_extent[0], cabot_extent[0], currier_extent[0], pforzheimer_extent[0])
  extent[1] = Math.max(mather_extent[1], dunster_extent[1], leverett_extent[1], kirkland_extent[1], eliot_extent[1], winthrop_extent[1], quincy_extent[1], lowell_extent[1], adams_extent[1], cabot_extent[1], currier_extent[1], pforzheimer_extent[1])
  y.domain(extent);
  
  g.append("path")
    .datum(mather_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#ff8800")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(dunster_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#82072a")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(leverett_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#ffd70f")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(kirkland_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#0021B1")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(eliot_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#0021B1")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(winthrop_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#dac4ff")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(lowell_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#000e93")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(adams_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#b57dce")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});
      
  g.append("path")
    .datum(quincy_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#00c4b3")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(cabot_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#5eabff")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(currier_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#b0ff32")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});

  g.append("path")
    .datum(pforzheimer_array)
    .attr("d", line)
    .attr("fill", "none")
    .attr("stroke", "#2a8c00")
    .attr("stroke-linejoin", "round")
    .attr("stroke-linecap", "round")
    .attr("stroke-width", 1.5)
    .style("stroke-width", "2.5px")
    .on("mouseover", function (d) {                                  
      d3.select(this)                          //on mouseover of each line, give it a nice thick stroke
      .style("stroke-width",'6px')
     
      })
    .on("mouseout", function(d) {        //undo everything on the mouseout
      d3.select(this)
      .style("stroke-width",'2.5px')});
}


//Axes Stuff
  g.append("g")
      .call(d3.axisLeft(y))
    .append("text")
      .attr("fill", "#000")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", "0.71em")
      .attr("text-anchor", "end")
      .text("Number of People Signed Up");

  g.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x))
      .append("text")
        .text("Date")
        .attr("fill", "#000")
        .attr("x", 6)
        .attr("dy", "0.71em")
        .attr("text-anchor", "end")
    .select(".domain")
      .remove();
  })

           


});

</script>